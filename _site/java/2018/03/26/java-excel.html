<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="/css/bootstrap.css">
	<link rel="stylesheet" href="/css/index.css">
    <script src="/js/love.js"></script>
    <script src="/js/jquery-1.11.0.js"></script>
    <script src="js/bootstrap.min.js"></script>
</head>
<body>
	
	<div id="wrapper">
        <div class="overlay"></div>
    
        <!-- Sidebar -->
        <nav class="navbar navbar-inverse navbar-fixed-top" id="sidebar-wrapper" role="navigation">
            <ul class="nav sidebar-nav">
                <li class="sidebar-brand">
                    <a href="#">
                       Bootstrap 3
                    </a>
                </li>
            </ul>
        </nav>
        <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
          <button type="button" class="hamburger is-closed animated fadeInLeft" data-toggle="offcanvas">
            <span class="hamb-top"></span>
            <span class="hamb-middle"></span>
            <span class="hamb-bottom"></span>
          </button>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">

                <div>
	<div>
		<h1>java读取修改excel</h1>
		<div>
			26 Mar 2018 • 晴天
		</div>
	</div>
	<hr>
	<article>
		<p>分析脚本执行结果，写入excel文件中。</p>

<p>引入jar包</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
            &lt;artifactId&gt;poi&lt;/artifactId&gt;
            &lt;version&gt;3.17&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
            &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;
            &lt;version&gt;3.17&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre></div></div>

<p>工具类以后遇到需求再补。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class ExcelUtil {
    //读取excel文件 以.xlsx结尾
    static List&lt;List&lt;String&gt;&gt; readExcel(String filePath) throws IOException {
        List&lt;List&lt;String&gt;&gt;result = new ArrayList&lt;&gt;();
        InputStream is = new FileInputStream(new File(filePath));
//        book表示一个excel文件
        XSSFWorkbook book = new XSSFWorkbook(is);
//        sheet表示一页
        for (Sheet sheet : book){
            if (null == sheet){
                continue;
            }
            //每一行
            for(int rowNum = 1;rowNum &lt;= sheet.getLastRowNum();rowNum++){
                XSSFRow xssfRow = (XSSFRow) sheet.getRow(rowNum);
                int minColIx = xssfRow.getFirstCellNum();
                int maxColIx = xssfRow.getLastCellNum();
                List&lt;String&gt;rowList = new ArrayList&lt;&gt;();
//                每一列
                for (int colIx = minColIx;colIx &lt; maxColIx;colIx++){
                    XSSFCell cell = xssfRow.getCell(colIx);
                    if(cell == null){
                        continue;
                    }
                    rowList.add(cell.toString());
                }
                result.add(rowList);
            }
        }
        return result;
    }
//    修改excel 第几页 第几列 以及修改后的内容
    static void modifyExcel(String filePath,int sheetNum,int colNum,String content) throws Exception {
        InputStream is = new FileInputStream(new File(filePath));
        XSSFWorkbook work = new XSSFWorkbook(is);
        FileOutputStream fos = new FileOutputStream(new File(filePath));
        XSSFSheet sheet = work.getSheetAt(sheetNum);
        for(Row row : sheet){
            for (Cell cell : row){
                if (cell.getColumnIndex() == colNum){
                    cell.setCellValue(content);
                }
            }
        }
        work.write(fos);
        work.close();
        fos.close();
        is.close();
    }
}

</code></pre></div></div>

<p>在读取并修改后，报错。</p>

<p><img src="/images/EmptyFileException.png" alt="EmptyFileException" /></p>

	</article>
	<hr>
</div>

                    </div>
                </div>
            </div>
        </div>
        <!-- /#page-content-wrapper -->

    </div>
    <!-- /#wrapper -->
	

	<script type="text/javascript">
		$(document).ready(function () {
		  var trigger = $('.hamburger'),
		      overlay = $('.overlay'),
		     isClosed = false;

		    trigger.click(function () {
		      hamburger_cross();      
		    });

		    function hamburger_cross() {

		      if (isClosed == true) {          
		        overlay.hide();
		        trigger.removeClass('is-open');
		        trigger.addClass('is-closed');
		        isClosed = false;
		      } else {   
		        overlay.show();
		        trigger.removeClass('is-closed');
		        trigger.addClass('is-open');
		        isClosed = true;
		      }
		  }
		  
		  $('[data-toggle="offcanvas"]').click(function () {
		        $('#wrapper').toggleClass('toggled');
		  });  
		});
	</script>
</body>
</html>